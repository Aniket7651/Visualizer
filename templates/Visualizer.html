{% extends 'base.htm' %}

{% block content %}

<section class="filter">
    <form method="post">
        {% csrf_token %}
        <select name="cancerType" id="cancerType" class="select-field">
            <option value="BreastCancer">Breast Cancer</option>
            <option value="LungCancer">Lung Cancer</option>
            <option value="ColorectalCancer">Colorectal Cancer</option>
            <option value="ProstateCancer">Prostate Cancer</option>
        </select>
        <button type="submit">Submit</button>
    </form>
</section>

<main>
    <h1>{{ head.heading }}</h1>
    <p>{{ head.title }}</p>

    <div class="tabs">
        <span class="tab" data-tab-value="#tab_1">Infrastructure</span>
        <span class="tab" data-tab-value="#tab_2">Cancer Screening</span>
        <span class="tab" data-tab-value="#tab_3">Reimbursement</span>
        <span class="tab" data-tab-value="#tab_4">Utilisation of Biomarker</span>
        <span class="tab" data-tab-value="#tab_5">Clinical Guidelines</span>
        <span class="tab" data-tab-value="#tab_6">Care & Diagnosis</span>
        <span class="tab" data-tab-value="#tab_7">Treatment Funding & Awareness</span>
    </div>
    <div class="tab-content">

        <!-- Tab 1 (Infrastructure, keep as) -->
        <div class="content tabs__tab active" id="tab_1" data-tab-info>
            <h2>Infrastructure</h2>
            <div class="row">
                <div class="cont">
                    <div class="column">
                        <h3>Strengths</h3>
                        <p>{{ content.strength_in }}</p>
                        <h3>Opportunities</h3>
                        <p>{{ content.opportunity_in }}</p>
                    </div>
                    <div class="column">
                        <h3>Weaknesses</h3>
                        <p>{{ content.weakness_in }}</p>
                        <h3>Threats</h3>
                        <p>{{ content.threats_in }}</p>
                    </div>
                </div>

                <!-- Map section -->
                <div class="map">
                    <div>
                        {% if map_type == 'sc' %}
                        <h2>Specialized Centers</h2>
                        {% elif map_type == 'gm' %}
                        <h2>Genetic & Molecular Testing</h2>
                        {% else %}
                        <h2>Specialized Canters</h2>
                        {% endif %}
                    </div>
                    <div id="geoChangable" style="height: fit-content;">
                        {% if geomap %}
                        {{ geomap|safe }}
                        {% else %}
                        <div>No map data available</div>
                        {% endif %}
                    </div>
                    <div class="map-buttons">
                        <form method="get" action="{% url 'infra' %}" style="display: inline;">
                            <input type="hidden" name="map_type" value="br_sc">
                            <button type="submit" {% if map_type == 'br_sc' %}class="active" {% endif %}>Specialized
                                Centers</button>
                        </form>
                        <form method="get" action="{% url 'infra' %}" style="display: inline;">
                            <input type="hidden" name="map_type" value="br_gm">
                            <button type="submit" {% if map_type == 'br_gm' %}class="active" {% endif %}>Genetic & Molecular
                                Testing</button>
                        </form>
                    </div>
                    <div class="map-icons">
                        <span><i class='fa fa-globe' style="font-size: 1.8rem;"></i></span>
                        <span><i class="fa fa-bar-chart" style="font-size: 1.8rem;"></i></span>
                        <span><i class="fa fa-download" style="font-size: 1.8rem;"></i></span>
                        <span><i class="fa fa-info" style="font-size: 1.8rem;"></i></span>
                    </div>
                </div>
            </div>

            <div class="chart-section">
                <h2 style="color: #604eb1;">Overall Average Design</h2>
                <div class="chart-wrapper">
                    <div id="scatter-chart">
                        {% if avgmap %}
                        {{ avgmap|safe }}
                        {% else %}
                        <div>No map data available</div>
                        {% endif %}
                    </div>
                    <div class="chart-icons">
                        <span><i class="fa fa-bar-chart"></i></span>
                        <span><i class="fa fa-download"></i></span>
                        <span><i class="fa fa-info"></i></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2 (Cancer screening, keep as) -->
        <div class="content tabs__tab" id="tab_2" data-tab-info>
            <h2>Cancer Screening</h2>
            <div class="row">
                <div class="cont">
                    <div class="column">
                        <h3>Strengths</h3>
                        <p>{{ content.strength_cs }}</p>
                        <h3>Opportunities</h3>
                        <p>{{ content.opportunity_cs }}</p>
                    </div>
                    <div class="column">
                        <h3>Weaknesses</h3>
                        <p>{{ content.weakness_cs }}</p>
                        <h3>Threats</h3>
                        <p>{{ content.threats_cs }}</p>
                    </div>
                </div>

                <div class="map">
                    <div id="geo_map" style="width: 100%;"></div>
                    <div class="map-buttons">

                        

                    </div>
                    <div class="map-icons">
                        <span><i class='fa fa-globe'></i></span>
                        <span><i class="fa fa-bar-chart"></i></span>
                        <span><i class="fa fa-download"></i></span>
                        <span><i class="fa fa-info"></i></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 3 (Reimbursement, keep as) -->
        <div class="content tabs__tab" id="tab_3" data-tab-info>
            <h2>Reimbursement</h2>
            <div class="row">
                <div class="cont">
                    <div class="column">
                        <h3>Strengths</h3>
                        <p>{{ content.strength_re }}</p>
                        <h3>Opportunities</h3>
                        <p>{{ content.opportunity_re }}</p>
                    </div>
                    <div class="column">
                        <h3>Weaknesses</h3>
                        <p>{{ content.weakness_re }}</p>
                        <h3>Threats</h3>
                        <p>{{ content.threats_re }}</p>
                    </div>
                </div>

                <div class="map">
                    <div id="geo_map" style="width: 100%;"></div>
                    <div class="map-buttons">

                        

                    </div>
                    <div class="map-icons">
                        <span><i class='fa fa-globe'></i></span>
                        <span><i class="fa fa-bar-chart"></i></span>
                        <span><i class="fa fa-download"></i></span>
                        <span><i class="fa fa-info"></i></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 4 (Utilization of Biomarkers, keep as) -->
        <div class="content tabs__tab" id="tab_4" data-tab-info>
            <h2>Utilization of Biomarkers</h2>
            <div class="row">
                <div class="cont">
                    <div class="column">
                        <h3>Strengths</h3>
                        <p>{{ content.strength_ub }}</p>
                        <h3>Opportunities</h3>
                        <p>{{ content.opportunity_ub }}</p>
                    </div>
                    <div class="column">
                        <h3>Weaknesses</h3>
                        <p>{{ content.weakness_ub }}</p>
                        <h3>Threats</h3>
                        <p>{{ content.threats_ub }}</p>
                    </div>
                </div>

                <div class="map">
                    <div id="geoChangable">
                        {% if ubmap %}
                        {{ ubmap|safe }}
                        {% else %}
                        <div>No map data available</div>
                        {% endif %}
                    </div>
                    <div class="map-buttons">

                        {% for btnValue, btnName in biomarker_btn %}
                        <form method="get" action="{% url 'infra' %}" style="display: inline;">
                            <input type="hidden" name="ubmap_type" value="{{ btnValue }}">
                            <button type="submit" {% if ubmap_type == '{{ btnValue }}' %}class="active" {% endif %}>{{ btnName }}</button>
                        </form>
                        {% endfor %}

                    </div>
                    <div class="map-icons">
                        <span><i class='fa fa-globe'></i></span>
                        <span><i class="fa fa-bar-chart"></i></span>
                        <span><i class="fa fa-download"></i></span>
                        <span><i class="fa fa-info"></i></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 5 (Clinical guide, keep as) -->
        <div class="content tabs__tab" id="tab_5" data-tab-info>
            <h2>Clinical Guidelines</h2>
            <div class="row">
                <div class="cont">
                    <div class="column">
                        <h3>Strengths</h3>
                        <p>{{ content.strength_cli }}</p>
                        <h3>Opportunities</h3>
                        <p>{{ content.opportunity_cli }}</p>
                    </div>
                    <div class="column">
                        <h3>Weaknesses</h3>
                        <p>{{ content.weakness_cli }}</p>
                        <h3>Threats</h3>
                        <p>{{ content.threats_cli }}</p>
                    </div>
                </div>

                <div class="map">
                    <div id="geo_map" style="width: 100%;"></div>
                    <div class="map-buttons">

                        

                    </div>
                    <div class="map-icons">
                        <span><i class='fa fa-globe'></i></span>
                        <span><i class="fa fa-bar-chart"></i></span>
                        <span><i class="fa fa-download"></i></span>
                        <span><i class="fa fa-info"></i></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 6 (care and diagnosis, keep as) -->
        <div class="content tabs__tab" id="tab_6" data-tab-info>
            <h2></h2>
            <div class="row">
                <div class="cont">
                    <div class="column">
                        <h3>Strengths</h3>
                        <p>{{ content.strength_sep }}</p>
                        <h3>Opportunities</h3>
                        <p>{{ content.opportunity_sep }}</p>
                    </div>
                    <div class="column">
                        <h3>Weaknesses</h3>
                        <p>{{ content.weakness_sep }}</p>
                        <h3>Threats</h3>
                        <p>{{ content.threats_sep }}</p>
                    </div>
                </div>

                <div class="map">
                    <div id="geo_map" style="width: 100%;"></div>
                    <div class="map-buttons">

                        

                    </div>
                    <div class="map-icons">
                        <span><i class='fa fa-globe'></i></span>
                        <span><i class="fa fa-bar-chart"></i></span>
                        <span><i class="fa fa-download"></i></span>
                        <span><i class="fa fa-info"></i></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Tab switching script (keep as is) -->
<script>
    const tabs = document.querySelectorAll('[data-tab-value]');
    const tabInfos = document.querySelectorAll('[data-tab-info]');
    const title = document.getElementById('title-section');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const target = document.querySelector(tab.dataset.tabValue);
            tabInfos.forEach(tabInfo => {
                tabInfo.classList.remove('active');
            });
            title.innerText = 'ICPC - ' + target.querySelector('h2').innerText;
            target.classList.add('active');
        });
    });
</script>

{% endblock %}